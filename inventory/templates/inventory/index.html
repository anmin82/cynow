{% extends 'base.html' %}
{% load humanize %}

{% block title %}재고 현황{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-box-seam me-2"></i>재고 현황</h2>
        {% if latest_snapshot %}
        <small class="text-muted">
            <i class="bi bi-clock me-1"></i>마지막 동기화: {{ latest_snapshot.snapshot_date }}
        </small>
        {% endif %}
    </div>
    
    <div class="row">
        <!-- 제품 재고 카드 -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header d-flex justify-content-between align-items-center bg-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-box me-2"></i>제품 재고 (창입)</h5>
                    <a href="{% url 'inventory:product' %}" class="btn btn-sm btn-light">상세</a>
                </div>
                <div class="card-body">
                    {% if product_summary %}
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>제품</th>
                                <th>가스명</th>
                                <th class="text-end">재고</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in product_summary %}
                            <tr>
                                <td>{{ item.trade_condition_code }}</td>
                                <td>{{ item.gas_name }}</td>
                                <td class="text-end fw-bold">{{ item.quantity|intcomma }}병</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p class="text-muted text-center my-4">제품 재고 데이터가 없습니다.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- 용기 재고 카드 -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header d-flex justify-content-between align-items-center bg-success text-white">
                    <h5 class="mb-0"><i class="bi bi-cylinder me-2"></i>용기 재고</h5>
                    <a href="{% url 'inventory:cylinder' %}" class="btn btn-sm btn-light">상세</a>
                </div>
                <div class="card-body">
                    {% if cylinder_summary %}
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th>가스명</th>
                                <th>상태</th>
                                <th class="text-end">수량</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in cylinder_summary %}
                            <tr>
                                <td>{{ item.gas_name }}</td>
                                <td>
                                    {% if item.status == 'FILLED' %}
                                    <span class="badge bg-success">충전</span>
                                    {% elif item.status == 'EMPTY' %}
                                    <span class="badge bg-secondary">빈용기</span>
                                    {% elif item.status == 'FILLING' %}
                                    <span class="badge bg-info">충전중</span>
                                    {% elif item.status == 'AT_CUSTOMER' %}
                                    <span class="badge bg-primary">고객</span>
                                    {% elif item.status == 'ANALYZING' %}
                                    <span class="badge bg-warning text-dark">분석</span>
                                    {% elif item.status == 'REPAIRING' %}
                                    <span class="badge bg-danger">수리</span>
                                    {% else %}
                                    <span class="badge bg-dark">{{ item.status }}</span>
                                    {% endif %}
                                </td>
                                <td class="text-end fw-bold">{{ item.total|intcomma }}병</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p class="text-muted text-center my-4">용기 재고 데이터가 없습니다.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

